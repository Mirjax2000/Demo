{% extends "base.html" %}
{% block title %}
    Historie zakázky {{ order.order_number }}
{% endblock title %}
<!---->
{% block content %}
    <h4 class="mt-3">Historie zakázky: {{ order.order_number|upper }}</h4>
    <hr>
    {% if history_data %}
        <ul class="list-unstyled">
            {% for entry in history_data %}
                <li class="lis">
                    <p class="mb-2">
                        Záznam ID: <strong>{{ entry.id }}</strong>
                    </p>
                    <p class="mb-2">
                        Uživatel: <strong>{{ entry.user|default:"Neznámý" }}</strong>
                    </p>
                    <p class="mb-2">
                        pred:<strong class="ms-2 me-2">{{ entry.date|timesince }}</strong>Datum změny: <strong>{{ entry.date }}</strong>
                    </p>
                    <p class="mb-2">
                        Typ změny:
                        {% if entry.type == '+' %}
                            <!---->
                            <span class="u-txt-success ms-2">Vytvoření</span>
                        {% endif %}
                        {% if entry.type == '~' %}
                            <!---->
                            <span class="u-txt-warning ms-2">Úprava</span>
                        {% endif %}
                        {% if entry.type == '-' %}
                            <!---->
                            <span class="u-txt-error ms-2">Smazání</span>
                        {% endif %}
                    </p>
                    {% if entry.changes %}
                        <h4>Změněná pole:</h4>
                        <ol>
                            {% for change in entry.changes %}
                                <li>
                                    Pole:
                                    <strong>{{ change.field }}</strong>: z
                                    <span class="u-txt-warning">{{ change.old }}</span> na
                                    <span class="u-txt-success">{{ change.new }}</span>
                                </li>
                            {% endfor %}
                        </ol>
                    {% endif %}
                    <hr>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>Pro tuto zakázku neexistuje žádná historie.</p>
    {% endif %}
{% endblock content %}
