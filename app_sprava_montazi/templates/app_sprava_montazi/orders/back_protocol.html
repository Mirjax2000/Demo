<!DOCTYPE html>
{% load static %}
<html lang="cs">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description"
              content="Rhenus HD - Asset Management System for maintenance and repair operations" />
        <meta name="keywords"
              content="rhenus, asset management, maintenance, repair, operations" />
        <title>Rhenus</title>
        {% include "includes/css.html" %}
    </head>
    <body>
        <div class="container text-center position-relative pt-5">
            {% for message in messages %}
                <div class="C-messages C-messages_custom_1 alert alert-{{ message.tags }} alert-dismissible fade show"
                     role="alert">
                    <strong>Message:</strong><span class="ms-2">{{ message|safe }}</span>
                    <button type="button"
                            class="btn-close"
                            data-bs-dismiss="alert"
                            aria-label="Close"></button>
                </div>
            {% endfor %}
            <h1 class="mb-4 pt-2">Zakázka: {{ order|upper }}</h1>
            <hr>
            <div class="row justify-content-center mt-4 mb-5">
                <div class="col-12 col-md-6">
                    <h3 class="text-start">Montážní tým: {{ order.team }}</h3>
                    <h3 class="text-start">Zákazník: {{ order.client }}</h3>
                </div>
            </div>
            <!---->
            <form action="{% url 'upload_protocol' order.pk %}"
                  method="post"
                  enctype="multipart/form-data">
                {% csrf_token %}
                <p>
                    max. velikost souboru je <strong>5MB</strong>!
                </p>
                <input class="d-none"
                       type="file"
                       id="fileInput"
                       name="image"
                       accept="image/*"
                       capture="environment" />
                <label for="fileInput"
                       class="btn btn-primary ps-5 pe-5 pt-2 pb-2 u-txt-bigger">
                    <i class="fa-solid fa-camera me-2"></i> Nahrát fotografii
                </label>
                <h3 id="fileError" class="mt-5"></h3>
            </form>
            <script>
    const fileInput = document.getElementById("fileInput");
    const fileError = document.getElementById("fileError");

    fileInput.addEventListener("change", function () {
        const file = fileInput.files[0];
        if (file && file.size > 5 * 1024 * 1024) {  // 5 MB
            const sizeMB = (file.size / 1024 / 1024).toFixed(2);
            fileError.innerHTML = `Soubor je příliš velký <strong class="u-txt-error">${sizeMB} MB</strong>.<br> Max.velikost je 5 MB.`;
            fileInput.value = "";  
        } else {
            fileError.textContent = "";
            fileInput.form.submit(); 
        }
    });
            </script>
        </div>
        {% include "includes/scripts.html" %}
    </body>
</html>
